---
title: 'STAT 8010: HW4'
date: '`r format(Sys.time(), "%B %d, %Y")`'
output:
    html_document:
    toc: true
    toc_depth: 3
    fig_width: 8.5
    fig_height: 8
    fig_caption: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1
This data set, *InvisibilityCloak.csv*, provides the number of mischievous acts
committed by two groups of people, those with and those without and invisibility
cloak. The variables in this data set are:

* **Participant**: Identification number of a participant.
* **Cloak**: Experimental group (0 = withouth a cloak of invisibility, 1 = with a
cloack of invisibility).
* **Mischief**: the number of mischievous acts committed by a participant.

Suppose a researcher would like to examine if invisibility cloak affects the number
mischievous acts committed.

### Load the data

```{r}
dat1 <- read.csv("./Data Sets/InvisibilityCloak.csv")
str(dat1)
dat1$Cloak <- as.factor(dat1$Cloak)
```

### a. State the null and alternative hypotheses
Let $\mu_{1} (\mu_{2})$ be the average number of mischievous acts committed by a participant withouth (with) a cloak of invisibility

$H_{0}: \mu_{1} - \mu_{2} = 0$ vs. $H_{a}: \mu_{1} - \mu_{2} \neq 0$

### Data summary 

```{r, message=FALSE}
library(dplyr)
summary1 <- dat1 %>%
select(Mischief, Cloak) %>%
group_by(Cloak) %>%
summarise(mean = mean(Mischief),
          sd = sd(Mischief),
          n = length(Mischief))
summary1
```

```{r}
boxplot(Mischief ~ Cloak, data = dat1, col = "gray",
        las = 1, boxwex = 0.5)
points(1, summary1$mean[1], pch = "*", cex = 1.5,
       col = "blue")
points(2, summary1$mean[2], pch = "*", cex = 1.5,
       col = "blue")
legend("toplef", legend = "Mean", pch = "*",
       col = "blue", bty = "n")
```

### Test for $\sigma_{1} = \sigma_{2}$

```{r}
var.test(Mischief ~ Cloak, data = dat1)
```

### Pooled-t test

```{r}
t.test(formula = Mischief ~ Cloak, data = dat1,
       var.equal = T)
```

### Non pooled-t test

```{r}
t.test(formula = Mischief ~ Cloak, data = dat1,
       var.equal = F)
```


## Problem 2
The data file, *Stereograms.csv*, records the time it took two groups of participants
to see a figure hidden in a stereogram - one group received advance information about
the scene, the other group did not. The variables in this data set are:

* **V1:**: Participant number.
* **fuseTime**: the time (in seconds) it took the participant to see the hidden figure.
* **condition**: experimental condition (NV = without information, VV = with
information).
* **logFuseTime:**: the log transformation of the fuseTime.

Suppose a researcher would like to investigate whether providing advance information
about the hidden figure shortens the time participant needs to see the figure.

### Load the data

```{r}
dat2 <- read.csv("./Data Sets/Stereograms.csv")
str(dat2)
```

### Data summary 

```{r, message=FALSE}
summary2 <- dat2 %>%
select(fuseTime, logFuseTime, condition) %>%
group_by(condition) %>%
summarise(mean = mean(fuseTime),
          sd = sd(fuseTime),
          n = length(fuseTime),
          mean_log = mean(logFuseTime),
          sd_log = sd(logFuseTime))
summary2
```

```{r}
boxplot(fuseTime ~ condition, data = dat2,
        col = "gray", las = 1, boxwex = 0.5,
        outcex = 0.75)
points(1, summary2$mean[1], pch = "*", cex = 1.5,
       col = "blue")
points(2, summary2$mean[2], pch = "*", cex = 1.5,
       col = "blue")
legend("toplef", legend = "Mean", pch = "*",
       col = "blue", bty = "n")

boxplot(logFuseTime ~ condition, data = dat2,
        col = "gray", las = 1, boxwex = 0.5,
        outcex = 0.75)
points(1, summary2$mean_log[1], pch = "*",
       cex = 1.5, col = "blue")
points(2, summary2$mean_log[2], pch = "*",
       cex = 1.5, col = "blue")
legend("toplef", legend = "Mean_log", pch = "*",
       col = "blue", bty = "n")
```


### b. State the null and alternative hypotheses.

Let $\mu_{1} (\mu_{2})$ be the average time (log-transformed) for a participant without (with) information to see the hidden figure   

$H_{0}: \mu_{1} - \mu_{2} = 0$ vs. $H_{a}: \mu_{1} - \mu_{2} > 0$


### Test for $\sigma_{1} = \sigma_{2}$

```{r}
var.test(logFuseTime ~ condition, data = dat2)
```


### Pooled-t test

```{r}
t.test(formula = logFuseTime ~ condition,
       data = dat2, alternative = "greater",
       var.equal = T)
```

### Non pooled-t test

```{r}
t.test(formula = logFuseTime ~ condition,
       data = dat2, alternative = "greater",
       var.equal = F)
```

## Problem 3

The file *WeightGain.csv* contains data from a study where weights of 16 participants
before and after an eight-week period of 1000 excessive calorie intake were recorded.
The variables in this data set are:

* **Weight Before**: Weight in pounds (lb) measured before eight weeks of excessive
calorie intake
* **Weight After**: Weight in pounds (lb) measured after eight weeks of excessive
calorie intake.

* **Difference**: Weight After - Weight Before

Suppose a researcher would like to investigate whether 1000 excess calorie intake per
day over 8 weeks results in, on average, 16 pounds weight increase.


### Load the data

```{r}
dat3 <- read.csv("./Data Sets/WeightGain.csv")
str(dat3)
```

### Data summary 

```{r, message=FALSE}
summary3 <- dat3 %>%
select(Weight.Before, Weight.After, Difference) %>%
summarise(mean_before = mean(Weight.Before),
          sd_before = sd(Weight.Before),
          n = length(Weight.Before),
          mean_after = mean(Weight.After),
          sd_after = sd(Weight.After),
          mean_diff = mean(Difference),
          sd_diff = sd(Difference))
summary3
```

### Paired t-test 

```{r}
t.test(dat3$Weight.After, dat3$Weight.Before,
       paired = TRUE, mu = 16)
```

### One sample t-test for difference

```{r}
t.test(dat3$Difference, mu = 16)
```






