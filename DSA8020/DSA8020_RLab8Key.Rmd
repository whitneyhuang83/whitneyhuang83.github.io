---
title: 'DSA 8020 R Lab 8: Randomized Complete Block Designs, Factorial Designs'
author: "Whitney"
date: '`r format(Sys.time(), "%B %d, %Y")`'
output:
  pdf_document:
    toc: true
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


A researcher wish to determine whether 4 different tips produce different hardness readings on a Rockwell hardness tester, where a hardness tester operates by pressing a
tip into a metal test "coupon". Since coupons are large enough to test four tips on,
a RCBD can be used, with one coupon as a block. The data set *tip_hardness.csv* can be found in Canvas.


1. Load the data into R

**Code:**

```{r}
dat <- read.csv("tip_hardness.csv", header = T)
dat$Tip <- as.factor(dat$Tip)
dat$Coupon <- as.factor(dat$Coupon)
```


2. Make side-by-side boxplots by treatment (Tip)

**Code:**

```{r}
boxplot(Hardness ~ Tip, data = dat, las = 1)
```

3. Write down the effets model, explain each term in the model (including the model assumptions regarding the random error)

**Answer:**

$$y_{ij} = \mu+\alpha_{i}+\beta_{j}+\epsilon_{ij},$$ 
where $\epsilon_{ij} {\sim} \mathrm{N}(0, \sigma^2)$

* $\mu$: overall mean
* $\alpha_{i}$: the effect of treatment $j$
* $\beta_{j}$: the effect of block $i$
* $\epsilon_{ij}$: random error, we assume the errors are normally distributed, they have constant variance (there is the same $\sigma^2$ across treatment groups), and they are independent.

We further assume there is no treatment/block interaction.

4. Perform an overall F-test to the treatment effects using ANOVA, state the hypotheses, p-value, and conclusion 

**Code:**

```{r}
lm <- lm(Hardness ~ Tip + Coupon, data = dat)
anova(lm)
```

**Answer:**

*Treatment effect*

$H_{0}:$ All 4 tips have equivalent hardness readings.
$H_{a}:$ At least one of the 4 tips has a different hardness reading.

*P-value*: 0.0008713. *Conclusion*: $0.0008713 < \alpha = 0.05 \Rightarrow$ so we reject $H_{0}$. There is sufficient evidence to suggest that at least one of the 4 tips has a different hardness reading.




5. Us interaction plot to assess the additivity assumption


**Code:**

```{r}
interaction.plot(dat$Tip, dat$Coupon, dat$Hardness, las = 1, col = 1:4)
```

**Answer:**

Coupons 1, 3, and 4 are approximately parallel to each other. However, Coupon 2 is not which implies that interaction occurs between tips and coupons.


In a study to evaluate the impact of a certain bacterical strain (mycoplasma) on the development of birds, birds inoculated with bacteria or a control injection were studied in both cold and warm termperature controlled rooms. The response variable of interest was the bill length of birds in the rooms. The rooms were the experimental units, either at cold or warm temperatures, containing control or mycoplasma inoculated birds. Two runs of each combination were performed.The data is given below:

Bact | Warm  | Cold 
-----| ------|-----
Control| 40.37, 41.71| 39.77, 40.23
Mycoplasma|40.21, 40.78|39.19, 38.95

6. Enter the data into R

**Code:**

```{r}
resp <- c(40.37, 41.71, 39.77, 40.23, 40.21, 40.78, 39.19, 38.95)
myco <- c(rep("Control", 4), rep("Mycoplasma", 4))
temp <- rep(c(rep("Warm", 2), rep("Cold", 2)), 2)
```

**Answer:**

7. Construct an ANOVA table that includes the main effects for bacteria and temperature and their interaction. Test whether the main effects impact bill length. 

**Code:**

```{r}
m1 <- lm(resp ~ myco * temp)
anova(m1)
```

**Answer:**

Bacteria type:
$H_{0}:$ Bacteria type does not impact bill length.
$H_{a}:$ Bacteria type does impact bill length.

*P-value*: 0.1290. *Conclusion*: $0.1290 > \alpha = 0.05 \Rightarrow$ so we fail to reject $H_{0}$. There is insufficient evidence to suggest that bacteria type impacts bill length.

Temperature level:
$H_{0}:$ Temperature level does not impact bill length.
$H_{a}:$ Temperature level does impact bill length.

*P-value*: 0.03324. *Conclusion*: $0.03324 < \alpha = 0.05 \Rightarrow$ so we reject $H_{0}$. There is sufficient evidence to suggest that temperature level impacts bill length.

Temperature/Bacteria interaction:
$H_{0}:$ There is no interaction effect between bacteria type and temperature level.
$H_{a}:$ There is interaction effect between bacteria type and temperature level

*P-value*: 0.64455. *Conclusion*: $0.03324 > \alpha = 0.05 \Rightarrow$ so we fail to reject $H_{0}$. There is insufficient evidence to suggest that there is interaction effect between bacteria type and temperature level.


8. Make an interaction plot and comment on the interaction effect

**Code:**

```{r}
interaction.plot(myco, temp, resp, las = 1, col = 1:4)
interaction.plot(temp, myco, resp, las = 1, col = 1:4)
```

**Answer:**

The two lines are approximately parallel so it is reasonable to assume that there is no interaction between temperature and bacteria type.





